{% extends "settings/layout.html" %}

{% block content %}
<nav aria-label="breadcrumb">
  <ul>
    <li><a href="/settings/sensors/">Sensors</a></li>
    <li>{{ sensor.name or '(unnamed)' }}</li>
  </ul>
</nav>

<hgroup>
  <h2>Edit Sensor</h2>
  <p>Update the details for this sensor.</p>
</hgroup>

<form method="post" action="/settings/sensors/{{ sensor.id }}/" style="max-width: 500px;">
  <label for="name">
    Name
    <input type="text" id="name" name="name" required value="{{ sensor.name or '' }}">
    <small>A descriptive name for this sensor.</small>
  </label>

  <label>
    Location
    <input type="text" value="{{ sensor.location_name }}" disabled>
    <small>Location cannot be changed after sensor creation.</small>
  </label>

  <fieldset>
    <label>
      <input type="checkbox" id="is_outdoor" name="is_outdoor" value="true" {% if sensor.is_outdoor %}checked{% endif %}>
      Outdoor sensor
    </label>
    <small>Mark this sensor as outdoor to use it for outdoor temperature readings.</small>
  </fieldset>

  <label for="color">
    Chart color
    <div style="display: flex; gap: 0.5rem; max-width: 250px;">
      <input type="color" id="color-picker" value="{{ sensor.color or '#808080' }}" title="Choose color" style="width: 60px; padding: 0.25rem;">
      <input type="text" id="color" name="color" value="{{ sensor.color or '' }}" placeholder="#rrggbb">
    </div>
    <small>Color to use in charts. Leave empty for auto-generated color.</small>
  </label>
  <script>
    // Sync color picker with text input
    const colorPicker = document.getElementById('color-picker');
    const colorInput = document.getElementById('color');
    colorPicker.addEventListener('input', (e) => {
      colorInput.value = e.target.value;
    });
    colorInput.addEventListener('input', (e) => {
      if (/^#[0-9A-Fa-f]{6}$/.test(e.target.value)) {
        colorPicker.value = e.target.value;
      }
    });
  </script>

  <div role="group">
    <button type="submit">Save Changes</button>
    <a href="/settings/sensors/" role="button" class="secondary">Cancel</a>
  </div>
</form>
{% endblock %}
